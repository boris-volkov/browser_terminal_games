<!doctype html><html lang="en"><head>  <meta charset="utf-8">  <title>Ѭ</title><link href="../../style.css" rel="stylesheet"/></head><body>

<div class="image">
	 <a href="main.html"> 
		<img class="screenshot" src="screenshot.png"></img>
	 </a> 
</div>

<div class="bookmark">./exe/princess/princess.html</div><pre class=html>
<kw>&lt!DOCTYPE html&gt</kw>
<kw>&lthtml&gt</kw>
  <kw>&lthead&gt</kw>
  <kw>&ltmeta charset="utf-8"&gt</kw>
  <kw>&ltmeta http-equiv="X-UA-Compatible" content="IE=edge"&gt</kw>
  <kw>&ltmeta name="viewport" content="width=device-width, initial-scale=1"&gt</kw>
  
  
  <kw>&ltlink rel="stylesheet" href="../xterm/css/xterm.css" /&gt</kw>
  <kw>&ltscript src="../xterm/lib/xterm.js"&gt</kw><kw>&lt/script&gt</kw>

  <kw>&lttitle&gt</kw>The Princess Test<kw>&lt/title&gt</kw>
<kw>&ltstyle&gt</kw>
body { background-color: #006699; }
<kw>&lt/style&gt</kw>
<kw>&lt/head&gt</kw>


  <kw>&ltbody&gt</kw>
   <kw>&ltmain&gt</kw>
      <kw>&ltdiv id="terminal" style="border-style: inset;"&gt</kw><kw>&lt/div&gt</kw>
      <kw>&ltscript src="princess.js"&gt</kw><kw>&lt/script&gt</kw>
     <kw>&lt/div&gt</kw>
    <kw>&lt/main&gt</kw>
  <kw>&lt/body&gt</kw>
<kw>&lt/html&gt</kw>
</pre>
<div class="bookmark">./exe/princess/main.html</div><pre class=html>
<kw>&lt!DOCTYPE html&gt</kw>
<kw>&lthtml&gt</kw>
  <kw>&lthead&gt</kw>
  <kw>&ltmeta charset="utf-8"&gt</kw>
  <kw>&ltmeta http-equiv="X-UA-Compatible" content="IE=edge"&gt</kw>
  <kw>&ltmeta name="viewport" content="width=device-width, initial-scale=1"&gt</kw>
  
  
  <kw>&ltlink rel="stylesheet" href="../xterm/css/xterm.css" /&gt</kw>
  <kw>&ltscript src="../xterm/lib/xterm.js"&gt</kw><kw>&lt/script&gt</kw>

  <kw>&lttitle&gt</kw>The Princess Test<kw>&lt/title&gt</kw>
<kw>&ltstyle&gt</kw>
body { background-color: #006699; }
<kw>&lt/style&gt</kw>
<kw>&lt/head&gt</kw>


  <kw>&ltbody&gt</kw>
   <kw>&ltmain&gt</kw>
      <kw>&ltdiv id="terminal" style="border-style: inset;"&gt</kw><kw>&lt/div&gt</kw>
      <kw>&ltscript src="rules.js"&gt</kw><kw>&lt/script&gt</kw>
     <kw>&lt/div&gt</kw>
    <kw>&lt/main&gt</kw>
  <kw>&lt/body&gt</kw>
<kw>&lt/html&gt</kw>
</pre>
<div class="bookmark">./exe/princess/princess.js</div><pre class=js>
<comment Class="js">//prompt<sc>(</sc>"got here"<sc>)</sc><sc>;</sc> // <kw>this</kw> is just a debugging thing, put <kw>this</kw> somewhere as a breakpoint
</comment>

<kw>const</kw> desired_rows = 15<sc>;</sc>

<kw>const</kw> white = <sgl_quote>'\x1b<sc>[</sc>97m'</sgl_quote><sc>;</sc>
<kw>const</kw> yellow = <sgl_quote>'\x1b<sc>[</sc>93m'</sgl_quote><sc>;</sc>
<kw>const</kw> blue = <sgl_quote>'\x1b<sc>[</sc>94m'</sgl_quote><sc>;</sc>
<kw>const</kw> red = <sgl_quote>'\x1b<sc>[</sc>91m'</sgl_quote><sc>;</sc>
<kw>const</kw> green = <sgl_quote>'\x1b<sc>[</sc>92m'</sgl_quote><sc>;</sc>

<kw>function</kw> princess<sc>(</sc>input<sc>)</sc><sc>{</sc>
	<kw>let</kw> head = input.charAt<sc>(</sc>0<sc>)</sc><sc>;</sc>
	<kw>let</kw> tail = input.charAt<sc>(</sc>input.length - 1<sc>)</sc><sc>;</sc>
	<kw>let</kw> rest = input.substring<sc>(</sc>1<sc>)</sc><sc>;</sc>

	<kw>if</kw> <sc>(</sc>head == <dbl_quote>"1"</dbl_quote> && tail == <dbl_quote>"2"</dbl_quote><sc>)</sc>
		<kw>return</kw> input.substring<sc>(</sc>1,input.length - 1<sc>)</sc><sc>;</sc>
	<kw>else</kw> <kw>if</kw> <sc>(</sc>head == <dbl_quote>"3"</dbl_quote><sc>)</sc>
		<kw>return</kw> princess<sc>(</sc>rest<sc>)</sc> + princess<sc>(</sc>rest<sc>)</sc><sc>;</sc>
	<kw>else</kw> <kw>if</kw> <sc>(</sc>head == <dbl_quote>"4"</dbl_quote><sc>)</sc>
		<kw>return</kw> princess<sc>(</sc>rest<sc>)</sc>.split<sc>(</sc><dbl_quote>""</dbl_quote><sc>)</sc>.reverse<sc>(</sc><sc>)</sc>.join<sc>(</sc><dbl_quote>""</dbl_quote><sc>)</sc><sc>;</sc>
	<kw>else</kw> <kw>if</kw> <sc>(</sc>head == <dbl_quote>"5"</dbl_quote><sc>)</sc>
		<kw>return</kw> princess<sc>(</sc>rest<sc>)</sc>.substring<sc>(</sc>1<sc>)</sc><sc>;</sc>
	<kw>else</kw> <kw>if</kw> <sc>(</sc>head == <dbl_quote>"6"</dbl_quote><sc>)</sc>
		<kw>return</kw> <dbl_quote>"1"</dbl_quote> + princess<sc>(</sc>rest<sc>)</sc><sc>;</sc>
	<kw>else</kw> <kw>if</kw> <sc>(</sc>head == <dbl_quote>"7"</dbl_quote><sc>)</sc>
		<kw>return</kw> <dbl_quote>"2"</dbl_quote> + princess<sc>(</sc>rest<sc>)</sc><sc>;</sc>
	<kw>else</kw>
		<kw>return</kw> <dbl_quote>""</dbl_quote><sc>;</sc>
<sc>}</sc>

<kw>function</kw> test1<sc>(</sc>input<sc>)</sc><sc>{</sc><kw>return</kw> <sc>(</sc>princess<sc>(</sc>input<sc>)</sc> == input<sc>)</sc><sc>;</sc><sc>}</sc>
<kw>function</kw> test2<sc>(</sc>input<sc>)</sc><sc>{</sc><kw>return</kw> <sc>(</sc>princess<sc>(</sc>input<sc>)</sc> == input + input<sc>)</sc><sc>;</sc><sc>}</sc>
<kw>function</kw> test3<sc>(</sc>input<sc>)</sc><sc>{</sc><kw>return</kw> <sc>(</sc>princess<sc>(</sc>input<sc>)</sc> == input.split<sc>(</sc><dbl_quote>""</dbl_quote><sc>)</sc>.reverse<sc>(</sc><sc>)</sc>.join<sc>(</sc><dbl_quote>""</dbl_quote><sc>)</sc><sc>)</sc><sc>;</sc><sc>}</sc>
<kw>function</kw> test4<sc>(</sc>input<sc>)</sc><sc>{</sc><kw>return</kw> <sc>(</sc>princess<sc>(</sc>input<sc>)</sc> == input.substring<sc>(</sc>0,input.length-1<sc>)</sc><sc>)</sc><sc>;</sc><sc>}</sc>
<kw>function</kw> test5<sc>(</sc>input<sc>)</sc><sc>{</sc><kw>return</kw> <sc>(</sc>princess<sc>(</sc>princess<sc>(</sc>input<sc>)</sc><sc>)</sc> == input<sc>)</sc><sc>;</sc><sc>}</sc>
<kw>function</kw> test6<sc>(</sc>input<sc>)</sc><sc>{</sc><kw>return</kw> <sc>(</sc>princess<sc>(</sc>princess<sc>(</sc>input<sc>)</sc><sc>)</sc> ==  input.split<sc>(</sc><dbl_quote>""</dbl_quote><sc>)</sc>.reverse<sc>(</sc><sc>)</sc>.join<sc>(</sc><dbl_quote>""</dbl_quote><sc>)</sc><sc>)</sc><sc>;</sc><sc>}</sc>


<kw>const</kw> reminder =<dbl_quote>"\n\rRule I                        "</dbl_quote>+green+<dbl_quote>"1"</dbl_quote>+white+<dbl_quote>"a"</dbl_quote>+green+<dbl_quote>"2"</dbl_quote>+white+<dbl_quote>" → a\n\r"</dbl_quote>+
	<dbl_quote>"Rule II        <kw>if</kw> a → b, then "</dbl_quote>+green+<dbl_quote>"3"</dbl_quote>+white+<dbl_quote>"a → bb\n\r"</dbl_quote>+
	<dbl_quote>"Rule III       <kw>if</kw> a → b, then "</dbl_quote>+green+<dbl_quote>"4"</dbl_quote>+white+<dbl_quote>"a → b↩\n\r"</dbl_quote>+
	<dbl_quote>"Rule IV        <kw>if</kw> a → b, then "</dbl_quote>+green+<dbl_quote>"5"</dbl_quote>+white+<dbl_quote>"a → ◌b\n\r"</dbl_quote>+
	<dbl_quote>"Rule V         <kw>if</kw> a → b, then "</dbl_quote>+green+<dbl_quote>"6"</dbl_quote>+white+<dbl_quote>"a → 1b\n\r"</dbl_quote>+
	<dbl_quote>"Rule VI        <kw>if</kw> a → b, then "</dbl_quote>+green+<dbl_quote>"7"</dbl_quote>+white+<dbl_quote>"a → 2b\n\n\r"</dbl_quote>


<comment Class="js">//TODO make these more engaging
</comment><kw>var</kw> prompts = 
	<sc>[</sc>
		yellow + <dbl_quote>"The first test<sc>:</sc> Echo\n\r"</dbl_quote>+
		<dbl_quote>"Get the princess to echo your number.\n\r"</dbl_quote>+ blue + 
		<dbl_quote>"	x → x\n\n\r"</dbl_quote> + white,

		yellow + <dbl_quote>"The second test<sc>:</sc>\n\r"</dbl_quote>+ blue + 
		<dbl_quote>"	x → xx\n\n\r"</dbl_quote> + white,

		yellow + <dbl_quote>"the third test<sc>:</sc>\n\r"</dbl_quote>+ blue + 
		<dbl_quote>"	x → x↩\n\n\r"</dbl_quote> + white,

		yellow + <dbl_quote>"the fourth test<sc>:</sc>\n\r"</dbl_quote>+ blue + 
		<dbl_quote>"	x → x◌ <sc>(</sc>final digit removed<sc>)</sc>\n\n\r"</dbl_quote>,

		yellow + <dbl_quote>"the fifth test<sc>:</sc>\n\r"</dbl_quote>+ blue + 
		<dbl_quote>"	x → y → x\n\n\r"</dbl_quote>,

		yellow + <dbl_quote>"the sixth test<sc>:</sc>\n\r"</dbl_quote>+ blue + 
		<dbl_quote>"	x → y → x↩'</sgl_quote>.\n\n\r"</dbl_quote>
	<sc>]</sc>

<kw>var</kw> tests = <sc>[</sc>test1, test2, test3, test4, test5, test6<sc>]</sc><sc>;</sc>
        <kw>const</kw> term = <kw>new</kw> Terminal<sc>(</sc>
                        <sc>{</sc>
                                theme<sc>:</sc> <sc>{</sc>
                                        background<sc>:</sc> <dbl_quote>"#882255"</dbl_quote>,
                                <sc>}</sc>,
                                rows<sc>:</sc> desired_rows,
                                cols<sc>:</sc> 60,
                                cursorBlink<sc>:</sc> true,
                                fontSize<sc>:</sc> Math.floor<sc>(</sc>innerHeight/<sc>(</sc>desired_rows*5/4<sc>)</sc><sc>)</sc>,
                                fontWeight<sc>:</sc> 900
                        <sc>}</sc><sc>)</sc><sc>;</sc>

	term.open<sc>(</sc>document.getElementById<sc>(</sc><sgl_quote>'terminal'</sgl_quote><sc>)</sc><sc>)</sc><sc>;</sc>
	<kw>const</kw> princess_prompt = <sgl_quote>'\r\nSend her a number...  '</sgl_quote><sc>;</sc>

	<kw>function</kw> runFakeTerminal<sc>(</sc><sc>)</sc> <sc>{</sc>
		<kw>var</kw> i = 0<sc>;</sc>

		term.write<sc>(</sc><sgl_quote>'\x1b<sc>[</sc>97m'</sgl_quote><sc>)</sc><sc>;</sc>
		term.writeln<sc>(</sc>prompts<sc>[</sc>i<sc>]</sc><sc>)</sc><sc>;</sc>
		prompt<sc>(</sc>term<sc>)</sc><sc>;</sc>

		<kw>var</kw> buffer = <dbl_quote>""</dbl_quote><sc>;</sc>

		term.onKey<sc>(</sc>e =&gt <sc>{</sc>
			<kw>const</kw> printable = <sc>!</sc>e.domEvent.altKey && <sc>!</sc>e.domEvent.altGraphKey && <sc>!</sc>e.domEvent.ctrlKey && <sc>!</sc>e.domEvent.metaKey<sc>;</sc>
			
			<kw>if</kw> <sc>(</sc><sc>[</sc>37,39,38,40<sc>]</sc>.includes<sc>(</sc>e.domEvent.keyCode<sc>)</sc><sc>)</sc> <kw>return</kw><sc>;</sc> <comment Class="js">// disable arrow keys <kw>for</kw> now they're buggy 
</comment>
			<kw>if</kw> <sc>(</sc>e.domEvent.keyCode === 13<sc>)</sc> <sc>{</sc>
				<kw>if</kw> <sc>(</sc>buffer == <dbl_quote>""</dbl_quote><sc>)</sc> <kw>return</kw><sc>;</sc>
				<kw>if</kw> <sc>(</sc>buffer == <dbl_quote>"?"</dbl_quote><sc>)</sc><sc>{</sc>
					term.write<sc>(</sc>reminder<sc>)</sc><sc>;</sc>
					prompt<sc>(</sc>term<sc>)</sc><sc>;</sc>
					buffer = <dbl_quote>""</dbl_quote><sc>;</sc>
					<kw>return</kw>
				<sc>}</sc>
				term.write<sc>(</sc><dbl_quote>"\r\n\x1b<sc>[</sc>94m"</dbl_quote> +  <dbl_quote>"The princess returns<sc>:</sc> "</dbl_quote> + princess<sc>(</sc>buffer<sc>)</sc> + <dbl_quote>"\x1b<sc>[</sc>97m"</dbl_quote><sc>)</sc><sc>;</sc>
				<kw>if</kw> <sc>(</sc>tests<sc>[</sc>i<sc>]</sc><sc>(</sc>buffer<sc>)</sc><sc>)</sc><sc>{</sc>
					i++<sc>;</sc>
					term.write<sc>(</sc><dbl_quote>"\x1b<sc>[</sc>91m\r\nYou passed Test "</dbl_quote> + i + <dbl_quote>"<sc>!</sc>\x1b<sc>[</sc>97m\r\n\n"</dbl_quote><sc>)</sc><sc>;</sc>
					term.write<sc>(</sc>prompts<sc>[</sc>i<sc>]</sc><sc>)</sc><sc>;</sc>
				<sc>}</sc>
				buffer = <dbl_quote>""</dbl_quote><sc>;</sc>
				prompt<sc>(</sc>term<sc>)</sc><sc>;</sc>
			<sc>}</sc> <kw>else</kw> <kw>if</kw> <sc>(</sc>e.domEvent.keyCode === 8<sc>)</sc> <sc>{</sc>
				<comment Class="js">// Do not <kw>delete</kw> the prompt
</comment>				<kw>if</kw> <sc>(</sc>term._core.buffer.x &gt princess_prompt.length - 2<sc>)</sc> <sc>{</sc>
					buffer = buffer.substring<sc>(</sc>0, buffer.length - 1<sc>)</sc><sc>;</sc>
					term.write<sc>(</sc><sgl_quote>'\b \b'</sgl_quote><sc>)</sc><sc>;</sc>
				<sc>}</sc>
			<sc>}</sc> <kw>else</kw> <kw>if</kw> <sc>(</sc>printable<sc>)</sc> <sc>{</sc>
				buffer = buffer + e.key<sc>;</sc>
				term.write<sc>(</sc>e.key<sc>)</sc><sc>;</sc>
			<sc>}</sc>
		<sc>}</sc><sc>)</sc><sc>;</sc>
	<sc>}</sc>

	        window.addEventListener<sc>(</sc><dbl_quote>"resize"</dbl_quote>, resize_term<sc>)</sc><sc>;</sc>
                <kw>function</kw> resize_term<sc>(</sc><sc>)</sc><sc>{</sc>
                        <kw>let</kw> font_height = Math.floor<sc>(</sc>innerHeight/<sc>(</sc>desired_rows*5/4<sc>)</sc><sc>)</sc><sc>;</sc>
                        term.setOption<sc>(</sc><dbl_quote>"fontSize"</dbl_quote>, font_height<sc>)</sc><sc>;</sc>
                <sc>}</sc>


	<kw>function</kw> prompt<sc>(</sc>term<sc>)</sc> <sc>{</sc>
		term.write<sc>(</sc>princess_prompt<sc>)</sc><sc>;</sc>
	<sc>}</sc>

	runFakeTerminal<sc>(</sc><sc>)</sc><sc>;</sc>
</pre>
<div class="bookmark">./exe/princess/rules.js</div><pre class=js>
<comment Class="js">/**
 * Test user on rules one at a time. 
 * Assert a set of pre-determined output values
 * Make sure uesr know how to use all of the rules
 */</comment>

<kw>const</kw> desired_rows = 24

<kw>function</kw> princess<sc>(</sc>input<sc>)</sc><sc>{</sc>
	<kw>var</kw> head = input.charAt<sc>(</sc>0<sc>)</sc><sc>;</sc>
	<kw>var</kw> tail = input.charAt<sc>(</sc>input.length - 1<sc>)</sc><sc>;</sc>
	<kw>var</kw> rest = input.substring<sc>(</sc>1<sc>)</sc><sc>;</sc>

	<kw>if</kw> <sc>(</sc>head == <dbl_quote>"1"</dbl_quote> && tail == <dbl_quote>"2"</dbl_quote><sc>)</sc>
		<kw>return</kw> input.substring<sc>(</sc>1,input.length - 1<sc>)</sc><sc>;</sc>
	<kw>else</kw> <kw>if</kw> <sc>(</sc>head == <dbl_quote>"3"</dbl_quote><sc>)</sc>
		<kw>return</kw> princess<sc>(</sc>rest<sc>)</sc> + princess<sc>(</sc>rest<sc>)</sc><sc>;</sc>
	<kw>else</kw> <kw>if</kw> <sc>(</sc>head == <dbl_quote>"4"</dbl_quote><sc>)</sc>
		<kw>return</kw> princess<sc>(</sc>rest<sc>)</sc>.split<sc>(</sc><dbl_quote>""</dbl_quote><sc>)</sc>.reverse<sc>(</sc><sc>)</sc>.join<sc>(</sc><dbl_quote>""</dbl_quote><sc>)</sc><sc>;</sc>
	<kw>else</kw> <kw>if</kw> <sc>(</sc>head == <dbl_quote>"5"</dbl_quote><sc>)</sc>
		<kw>return</kw> princess<sc>(</sc>rest<sc>)</sc>.substring<sc>(</sc>1<sc>)</sc><sc>;</sc>
	<kw>else</kw> <kw>if</kw> <sc>(</sc>head == <dbl_quote>"6"</dbl_quote><sc>)</sc>
		<kw>return</kw> <dbl_quote>"1"</dbl_quote> + princess<sc>(</sc>rest<sc>)</sc><sc>;</sc>
	<kw>else</kw> <kw>if</kw> <sc>(</sc>head == <dbl_quote>"7"</dbl_quote><sc>)</sc>
		<kw>return</kw> <dbl_quote>"2"</dbl_quote> + princess<sc>(</sc>rest<sc>)</sc><sc>;</sc>
	<kw>else</kw>
		<kw>return</kw> <dbl_quote>""</dbl_quote><sc>;</sc>
<sc>}</sc>

<kw>const</kw> white = <sgl_quote>'\x1b<sc>[</sc>97m'</sgl_quote><sc>;</sc>
<kw>const</kw> yellow = <sgl_quote>'\x1b<sc>[</sc>93m'</sgl_quote><sc>;</sc>
<kw>const</kw> blue = <sgl_quote>'\x1b<sc>[</sc>94m'</sgl_quote><sc>;</sc>
<kw>const</kw> red = <sgl_quote>'\x1b<sc>[</sc>91m'</sgl_quote><sc>;</sc>
<kw>const</kw> green = <sgl_quote>'\x1b<sc>[</sc>92m'</sgl_quote><sc>;</sc>

<kw>const</kw> INTRODUCTION = yellow + <dbl_quote>"There is a princess who lives far away,\n\r"</dbl_quote> + 
	<dbl_quote>"She has a way <kw>with</kw> numbers, by the way.\n\r"</dbl_quote> + 
	<dbl_quote>"She has <kw>this</kw> game she plays, a number game<sc>:</sc>\n\r"</dbl_quote>+
	<dbl_quote>"You send her a number, she'</sgl_quote>ll <kw>do</kw> the same.\n\r"</dbl_quote>+
	<dbl_quote>"Her number will be <kw>in</kw> response to yours,\n\r"</dbl_quote>+
	<dbl_quote>"And yes, She'</sgl_quote>ll teach you how it works, of course.\n\r"</dbl_quote>+
	<dbl_quote>"She will reward the one that meets her test,\n\r"</dbl_quote>+
	<dbl_quote>"Just learn six rules and figure out the rest.\n\r"</dbl_quote>+
	<dbl_quote>"The princess is waiting...\n\r"</dbl_quote>+ 
	<dbl_quote>"First she will teach you the rules.\n\n\r"</dbl_quote>+
	<dbl_quote>"<sc>(</sc>Already know the rules? press ESC<sc>)</sc>\n\n\r"</dbl_quote>+
	green + <dbl_quote>"Tell the princess you are ready<sc>:</sc>"</dbl_quote>

<kw>const</kw> rules = 
	<sc>[</sc>
		yellow + <dbl_quote>"Rule 0<sc>:</sc> notation\n\r"</dbl_quote>+ white + 
		<dbl_quote>"▸ A single letter can be used to represent\n\r"</dbl_quote>+
		<dbl_quote>"	either a single-digit, or a multi-digit number.\n\r"</dbl_quote>+
		<dbl_quote>"	So x can be 2 or it can be 1234\n\r"</dbl_quote>+
		<dbl_quote>"▸ No letter has any special meaning,\n\r"</dbl_quote>+
		<dbl_quote>"	they are all just variables <sc>(</sc>a,b,x<sc>)</sc>\n\r"</dbl_quote>+
		<dbl_quote>"▸ When you see variables next to each other,\n\r"</dbl_quote>+
		<dbl_quote>"	it means concatenation, not multiplication\n\r"</dbl_quote>+
		<dbl_quote>"	so <kw>if</kw> a = 543 and b = 987 ab means 543987\n\r"</dbl_quote>+
		<dbl_quote>"	and 3a means 3543\n\r"</dbl_quote>+
		<dbl_quote>"▸ a → b means<sc>:</sc> when you send the princess a,\n\r"</dbl_quote>+
		<dbl_quote>"	       she will respond <kw>with</kw> b.\n\n\r"</dbl_quote>+
		yellow + <dbl_quote>"Rule I<sc>:</sc> getting a response\n\r"</dbl_quote>+ white + 	
		<dbl_quote>"		<sc>(</sc>"</dbl_quote>+green+<dbl_quote>"1"</dbl_quote>+white+<dbl_quote>"a"</dbl_quote>+green+<dbl_quote>"2"</dbl_quote>+white+<dbl_quote>" → a<sc>)</sc>\n\r"</dbl_quote> + 
		<dbl_quote>"Examples<sc>:</sc> 	"</dbl_quote>+green+<dbl_quote>"1"</dbl_quote>+white+<dbl_quote>"654"</dbl_quote>+green+<dbl_quote>"2"</dbl_quote>+white+<dbl_quote>" → 654\n\r"</dbl_quote>+
		<dbl_quote>"		"</dbl_quote>+green+<dbl_quote>"1"</dbl_quote>+white+<dbl_quote>"192"</dbl_quote>+green+<dbl_quote>"2"</dbl_quote>+white+<dbl_quote>" → 192\n\r"</dbl_quote>+
		<dbl_quote>"Play <kw>with</kw> the rule. Does it make sense?\n\r"</dbl_quote>+
		<dbl_quote>"What number would you send to get 1643 back\n\r"</dbl_quote>+
		<dbl_quote>"<kw>in</kw> the notation<sc>:</sc> Find an x such that<sc>:</sc> x → 1643\n\n\r"</dbl_quote>,

		yellow + <dbl_quote>"RULE II<sc>:</sc> doubling\n\r"</dbl_quote>+ 
		<dbl_quote>"<sc>(</sc><kw>if</kw> a → b then 3a → bb<sc>)</sc>\n\r"</dbl_quote>+ white +
		<dbl_quote>"Examples<sc>:</sc>      Since 116432 → 1643\n\r"</dbl_quote>+
		<dbl_quote>"	       then "</dbl_quote>+green+<dbl_quote>"3"</dbl_quote>+white+<dbl_quote>"116432 → 16431643\n\r"</dbl_quote>+
		<dbl_quote>"		Since 1432 → 43\n\r"</dbl_quote>+
		<dbl_quote>"		then "</dbl_quote>+green+<dbl_quote>"3"</dbl_quote>+white+<dbl_quote>"1432 → 4343\n\r"</dbl_quote>+
		<dbl_quote>"                and "</dbl_quote>+green+<dbl_quote>"33"</dbl_quote>+white+<dbl_quote>"1432 → 43434343\n\r"</dbl_quote>+
		<dbl_quote>"Using rule II<sc>:</sc>\n\r"</dbl_quote>+
		<dbl_quote>"What number would you send to get 123123 back?\n\r"</dbl_quote>+
		<dbl_quote>"                   x → 123123\n\n\n\r"</dbl_quote>,

		yellow + <dbl_quote>"RULE III<sc>:</sc> reversal\n\r"</dbl_quote>+ 
		<dbl_quote>"<sc>(</sc><kw>if</kw> a → b, then 4a → b↩ <sc>(</sc>b <kw>with</kw> its digits reversed<sc>)</sc><sc>)</sc>\n\r"</dbl_quote>+ white +
		<dbl_quote>"Example<sc>:</sc>      since 19872 → 987\n\r"</dbl_quote>+
		<dbl_quote>"	      then "</dbl_quote>+green+<dbl_quote>"4"</dbl_quote>+white+<dbl_quote>"19872 → 789\n\r"</dbl_quote>+
		<dbl_quote>"Use rule III to make her send back 123\n\r"</dbl_quote>,

		yellow + <dbl_quote>"Rule IV<sc>:</sc> ereasure\n\r"</dbl_quote>+
		<dbl_quote>"<sc>(</sc><kw>if</kw> a → b, then 5a→ ◌b <sc>(</sc>b <kw>with</kw> the first digit removed<sc>)</sc><sc>)</sc>\n\r"</dbl_quote>+ white +
		<dbl_quote>"Example<sc>:</sc>     since  127432 → 2743\n\r"</dbl_quote>+
		<dbl_quote>"	     then  "</dbl_quote>+green+<dbl_quote>"5"</dbl_quote>+white+<dbl_quote>"127432 → 743\n\r"</dbl_quote>+
		<dbl_quote>"Use rule IV to make her send back 375\n\r"</dbl_quote>,

		yellow + <dbl_quote>"Rule V<sc>:</sc> addition<sc>(</sc>1<sc>)</sc> <sc>(</sc><kw>if</kw> a → b then 6a → 1b<sc>)</sc>\n\r"</dbl_quote>+ white + 
		<dbl_quote>"Example<sc>:</sc>      since 15552 → 555\n\r"</dbl_quote>+
		<dbl_quote>"              then "</dbl_quote>+green+<dbl_quote>"6"</dbl_quote>+white+<dbl_quote>"15552 → 1555\n\r"</dbl_quote>+
		<dbl_quote>"Use rule V to <kw>return</kw> 1919\n\r"</dbl_quote>,

		yellow + <dbl_quote>"Rule VI<sc>:</sc> addition<sc>(</sc>2<sc>)</sc> <sc>(</sc><kw>if</kw> a → b then 7a → 2b<sc>)</sc>\n\r"</dbl_quote>+ white +
		<dbl_quote>"Example<sc>:</sc>      since 13432 → 343\n\r"</dbl_quote>+
		<dbl_quote>"              then "</dbl_quote>+green+<dbl_quote>"7"</dbl_quote>+white+<dbl_quote>"13432 → 2343\n\r"</dbl_quote>+
		<dbl_quote>"Use rule VI to <kw>return</kw> 222\n\r"</dbl_quote>,

		yellow + <dbl_quote>"Rule ∞<sc>:</sc> rules can be used <kw>in</kw> any combination\n\r"</dbl_quote>+ white +
		<dbl_quote>"Example<sc>:</sc>      since   14342 →  434\n\r"</dbl_quote>+
		<dbl_quote>"               and   "</dbl_quote>+green+<dbl_quote>"6"</dbl_quote>+white+<dbl_quote>"14342 → 1434       <sc>(</sc>addition<sc>(</sc>1<sc>)</sc><sc>)</sc>\n\r"</dbl_quote>+
		<dbl_quote>"              then  "</dbl_quote>+green+<dbl_quote>"36"</dbl_quote>+white+<dbl_quote>"14342 → 14341434   <sc>(</sc>doubling<sc>)</sc>\n\r"</dbl_quote>+
		<dbl_quote>"Use rules IV<sc>(</sc>ereasure<sc>)</sc> and II<sc>(</sc>doubling<sc>)</sc> to get the \n\r"</dbl_quote>+
		<dbl_quote>"princess to send you the number 47747\n\r"</dbl_quote>,

		red + <dbl_quote>"And those are all the rules.\n\n\r"</dbl_quote> + white + 
		<dbl_quote>"Do not forget them<sc>:</sc>\n\n\n\r"</dbl_quote>+
		<dbl_quote>"Rule I                        "</dbl_quote>+green+<dbl_quote>"1"</dbl_quote>+white+<dbl_quote>"a"</dbl_quote>+green+<dbl_quote>"2"</dbl_quote>+white+<dbl_quote>" → a\n\r"</dbl_quote>+
		<dbl_quote>"Rule II        <kw>if</kw> a → b, then "</dbl_quote>+green+<dbl_quote>"3"</dbl_quote>+white+<dbl_quote>"a → bb\n\r"</dbl_quote>+
		<dbl_quote>"Rule III       <kw>if</kw> a → b, then "</dbl_quote>+green+<dbl_quote>"4"</dbl_quote>+white+<dbl_quote>"a → b↩\n\r"</dbl_quote>+
		<dbl_quote>"Rule IV        <kw>if</kw> a → b, then "</dbl_quote>+green+<dbl_quote>"5"</dbl_quote>+white+<dbl_quote>"a → ◌b\n\r"</dbl_quote>+
		<dbl_quote>"Rule V         <kw>if</kw> a → b, then "</dbl_quote>+green+<dbl_quote>"6"</dbl_quote>+white+<dbl_quote>"a → 1b\n\r"</dbl_quote>+
		<dbl_quote>"Rule VI        <kw>if</kw> a → b, then "</dbl_quote>+green+<dbl_quote>"7"</dbl_quote>+white+<dbl_quote>"a → 2b\n\n\r"</dbl_quote>+
		<dbl_quote>"Now you are ready <kw>for</kw> the tests ↴\n\r"</dbl_quote>+
		<dbl_quote>"Send the princess a ? <kw>if</kw> you need a reminder...\n\r"</dbl_quote>+
		<dbl_quote>"Press ENTER to go to the tests"</dbl_quote>
	<sc>]</sc>

<comment Class="js">// <kw>this</kw> is how we make sure they understand the rules
</comment><kw>const</kw> asserts = 
	<sc>[</sc>    <comment Class="js">// <sc>(</sc>required number, test assert equal<sc>)</sc>   
</comment>		<sc>[</sc><dbl_quote>"1"</dbl_quote>,<dbl_quote>"1643"</dbl_quote><sc>]</sc>,
		<sc>[</sc><dbl_quote>"3"</dbl_quote>,<dbl_quote>"123123"</dbl_quote><sc>]</sc>,
		<sc>[</sc><dbl_quote>"4"</dbl_quote>, <dbl_quote>"123"</dbl_quote><sc>]</sc>,
		<sc>[</sc><dbl_quote>"5"</dbl_quote>, <dbl_quote>"375"</dbl_quote><sc>]</sc>,
		<sc>[</sc><dbl_quote>"6"</dbl_quote>, <dbl_quote>"1919"</dbl_quote><sc>]</sc>,
		<sc>[</sc><dbl_quote>"7"</dbl_quote>, <dbl_quote>"222"</dbl_quote><sc>]</sc>,
		<sc>[</sc><dbl_quote>"53"</dbl_quote>, <dbl_quote>"47747"</dbl_quote><sc>]</sc>
	<sc>]</sc>

<comment Class="js">/**
 * pass it the buffer, and where to look in the asserts aray
 */</comment>
<kw>function</kw> test<sc>(</sc>input, i<sc>)</sc><sc>{</sc>
	<kw>return</kw> <sc>(</sc><sc>(</sc>input.startsWith<sc>(</sc>asserts<sc>[</sc>i<sc>]</sc><sc>[</sc>0<sc>]</sc><sc>)</sc><sc>)</sc> && <sc>(</sc>princess<sc>(</sc>input<sc>)</sc> == asserts<sc>[</sc>i<sc>]</sc><sc>[</sc>1<sc>]</sc><sc>)</sc><sc>)</sc><sc>;</sc>
<sc>}</sc>


<kw>const</kw> term = <kw>new</kw> Terminal<sc>(</sc>
	<sc>{</sc>
		theme<sc>:</sc> <sc>{</sc>
			background<sc>:</sc> <dbl_quote>"#006699"</dbl_quote>,
		<sc>}</sc>,
		rows<sc>:</sc> desired_rows,
		cols<sc>:</sc> 60,
		cursorBlink<sc>:</sc> true,
		fontSize<sc>:</sc> Math.floor<sc>(</sc>innerHeight/<sc>(</sc>desired_rows*5/4<sc>)</sc><sc>)</sc>,
		fontWeight<sc>:</sc> 700,
	<sc>}</sc><sc>)</sc><sc>;</sc>

term.open<sc>(</sc>document.getElementById<sc>(</sc><sgl_quote>'terminal'</sgl_quote><sc>)</sc><sc>)</sc><sc>;</sc>

<kw>const</kw> term_prompt = <sgl_quote>'\r\nTry a number<sc>:</sc> '</sgl_quote><sc>;</sc>

<kw>function</kw> runFakeTerminal<sc>(</sc><sc>)</sc> <sc>{</sc>
	<kw>if</kw> <sc>(</sc>term._initialized<sc>)</sc> <sc>{</sc>
		<kw>return</kw><sc>;</sc>
	<sc>}</sc>

	term._initialized = true<sc>;</sc>

	term.write<sc>(</sc><sgl_quote>'\x1b<sc>[</sc>97m'</sgl_quote><sc>)</sc><sc>;</sc> <comment Class="js">// sets text color
</comment>	term.write<sc>(</sc>INTRODUCTION<sc>)</sc><sc>;</sc>

	<kw>var</kw> i = 0<sc>;</sc> 		<comment Class="js">// index to iterate through the rules
</comment>	started = <kw>false</kw><sc>;</sc>

	<kw>var</kw> buffer = <dbl_quote>""</dbl_quote><sc>;</sc> <comment Class="js">// initialize an empty buffer. I think <kw>this</kw> can be accessed 
</comment>	<comment Class="js">// through term._core.buffer instead of building manually
</comment>
	term.onKey<sc>(</sc>e =&gt <sc>{</sc>
		<kw>if</kw> <sc>(</sc>e.domEvent.keyCode === 27<sc>)</sc><sc>{</sc>
			term.dispose<sc>(</sc><sc>)</sc><sc>;</sc>
			location.replace<sc>(</sc><dbl_quote>"princess.html"</dbl_quote><sc>)</sc><sc>;</sc> <comment Class="js">//<kw>this</kw> might be the fix<sc>:</sc> send to another html page <kw>with</kw> another terminal
</comment>		<sc>}</sc>

		<kw>if</kw> <sc>(</sc><sc>[</sc>37,39,38,40<sc>]</sc>.includes<sc>(</sc>e.domEvent.keyCode<sc>)</sc><sc>)</sc> <kw>return</kw><sc>;</sc> <comment Class="js">// disable arrow keys <kw>for</kw> now, they're buggy 
</comment>
		<kw>const</kw> printable = <sc>!</sc>e.domEvent.altKey && <sc>!</sc>e.domEvent.altGraphKey && <sc>!</sc>e.domEvent.ctrlKey && <sc>!</sc>e.domEvent.metaKey<sc>;</sc>

		<kw>if</kw> <sc>(</sc>started == <kw>false</kw><sc>)</sc> <sc>{</sc> <comment Class="js">// started means they read the intro and are going through the rules now
</comment>			term.reset<sc>(</sc><sc>)</sc><sc>;</sc>
			buffer = <dbl_quote>""</dbl_quote><sc>;</sc>
			term.writeln<sc>(</sc>rules<sc>[</sc>0<sc>]</sc><sc>)</sc><sc>;</sc>
			prompt<sc>(</sc>term<sc>)</sc><sc>;</sc>
			started = true<sc>;</sc>
			<kw>return</kw><sc>;</sc>
		<sc>}</sc>

		<kw>if</kw> <sc>(</sc>e.domEvent.keyCode === 13<sc>)</sc> 
		<sc>{</sc>
			<kw>if</kw> <sc>(</sc>buffer == <dbl_quote>""</dbl_quote><sc>)</sc> <kw>return</kw><sc>;</sc> <comment Class="js">// don't <kw>let</kw> them send an empty string
</comment>
			<kw>if</kw> <sc>(</sc>i == rules.length-1<sc>)</sc><sc>{</sc>
				term.dispose<sc>(</sc><sc>)</sc><sc>;</sc> <comment Class="js">//done learning rules.
</comment>				location.replace<sc>(</sc><dbl_quote>"princess.html"</dbl_quote><sc>)</sc><sc>;</sc>
			<sc>}</sc>

			term.writeln<sc>(</sc><dbl_quote>"\n\rthe princess would <kw>return</kw><sc>:</sc> "</dbl_quote> + princess<sc>(</sc>buffer<sc>)</sc><sc>)</sc><sc>;</sc>
			<kw>if</kw> <sc>(</sc>test<sc>(</sc>buffer, i<sc>)</sc><sc>)</sc><sc>{</sc>
				i++<sc>;</sc>
				term.writeln<sc>(</sc>green + <dbl_quote>"\n\n\n    Correct\n\n\n\n\r"</dbl_quote><sc>)</sc><sc>;</sc>
				term.writeln<sc>(</sc>rules<sc>[</sc>i<sc>]</sc><sc>)</sc><sc>;</sc>
				<kw>if</kw> <sc>(</sc>i == rules.length - 1<sc>)</sc> <kw>return</kw><sc>;</sc> <comment Class="js">// so we don't prompt after the rules print out
</comment>				<comment Class="js">// is it stupid to check <kw>this</kw> twice? probably.		
</comment>			<sc>}</sc>

			buffer = <dbl_quote>""</dbl_quote><sc>;</sc>
			prompt<sc>(</sc>term<sc>)</sc><sc>;</sc>

		<sc>}</sc> <kw>else</kw> <kw>if</kw> <sc>(</sc>e.domEvent.keyCode === 8<sc>)</sc> <sc>{</sc> <comment Class="js">// backspace
</comment>			<comment Class="js">// Do not <kw>delete</kw> the prompt
</comment>			<kw>if</kw> <sc>(</sc>term._core.buffer.x &gt term_prompt.length - 2<sc>)</sc> <sc>{</sc>
				buffer = buffer.substring<sc>(</sc>0, buffer.length - 1<sc>)</sc><sc>;</sc>
				term.write<sc>(</sc><sgl_quote>'\b \b'</sgl_quote><sc>)</sc><sc>;</sc>
			<sc>}</sc>
		<sc>}</sc> <kw>else</kw> <kw>if</kw> <sc>(</sc>printable<sc>)</sc> <sc>{</sc>
			buffer = buffer + e.key<sc>;</sc>
			term.write<sc>(</sc>e.key<sc>)</sc><sc>;</sc>
		<sc>}</sc>

	<sc>}</sc><sc>)</sc><sc>;</sc>

	window.addEventListener<sc>(</sc><dbl_quote>"resize"</dbl_quote>, resize_term<sc>)</sc><sc>;</sc>
	<kw>function</kw> resize_term<sc>(</sc><sc>)</sc><sc>{</sc>
		<kw>let</kw> font_height = Math.floor<sc>(</sc>innerHeight/<sc>(</sc>desired_rows*5/4<sc>)</sc><sc>)</sc><sc>;</sc>
		term.setOption<sc>(</sc><dbl_quote>"fontSize"</dbl_quote>, font_height<sc>)</sc><sc>;</sc>
	<sc>}</sc>

<sc>}</sc>

<kw>function</kw> prompt<sc>(</sc>term<sc>)</sc> <sc>{</sc>
	term.write<sc>(</sc>term_prompt<sc>)</sc><sc>;</sc>
<sc>}</sc>

runFakeTerminal<sc>(</sc><sc>)</sc><sc>;</sc>
</pre>
</body></html>